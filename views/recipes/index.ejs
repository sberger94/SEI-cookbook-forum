<%- include('../partials/header') %>

<table>
    <thead>
        <tr>
            <th>Recipe</th>
            <th>Rating</th>
            <th>Author</th>
        </tr>
    </thead>
    <tbody>
        <% recipes.forEach(function(recipe) { %>
            <tr>
                <td><a href="/recipes/<%= recipe._id %>"><%= recipe.title %></a></td>
                <% if(recipe.reviews.length) { %>
                    <% let total = 0 %>
                    <% recipe.reviews.forEach(function(r) { %>
                        <% total += r.rating %>
                    <% }); %>
                    <td id="stars"><%= (total / recipe.reviews.length).toFixed(1) %><span>(<%= recipe.reviews.length %>)</span></td>
                <% } else { %>
                    <td><h5>No Reviews Yet</h5></td>
                <% } %>
                <td><%= recipe.userName %></td>
            </tr>
        <% }); %>
    </tbody>
</table>

<%- include('../partials/footer') %>